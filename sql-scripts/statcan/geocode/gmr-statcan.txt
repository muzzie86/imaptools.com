update as_config set grammar=$$
[ADDRESS]
@HOUSE @STREET @PLACE @PROV
@HOUSE @STREET @PLACE @PROV @COUNTRY
# NOTE: STATCAN does not have postcodes in the dataset
# @POST is to recognize them and ignore them
@HOUSE @STREET @PLACE @PROV @POST
@HOUSE @STREET @PLACE @PROV @POST @COUNTRY

[COUNTRY]
NATION -> NATION -> 1.0

[POST]
PCH PCT -> POSTAL POSTAL -> 0.9
MIXED MIXED -> POSTAL POSTAL -> 0.5
PCH -> POSTAL -> 0.4
MIXED -> POSTAL -> 0.3

[PROV]
PROV -> PROV -> 0.9

[PLACE]
CITY -> CITY -> 0.9
DIRECT DIRECT WORD -> CITY CITY CITY -> 0.4
DIRECT DOUBLE WORD -> CITY CITY CITY -> 0.5
DIRECT TYPE -> CITY CITY -> 0.5
DIRECT TYPE WORD -> CITY CITY CITY -> 0.4
DIRECT WORD -> CITY CITY -> 0.3
DIRECT WORD TYPE -> CITY CITY CITY -> 0.4
DIRECT WORD WORD -> CITY CITY CITY -> 0.3
DOUBLE WORD -> CITY CITY -> 0.4
NUMBER WORD TYPE -> CITY CITY CITY -> 0.5
NUMBER WORD WORD -> CITY CITY CITY -> 0.4
PROV TYPE -> CITY CITY -> 0.5
PROV TYPE WORD TYPE -> CITY CITY CITY CITY -> 0.5
PROV WORD -> CITY CITY -> 0.5
PROV WORD DIRECT WORD WORD -> CITY CITY CITY CITY CITY -> 0.5
SINGLE TYPE WORD -> CITY CITY CITY -> 0.4
SINGLE WORD NUMBER -> CITY CITY CITY -> 0.4
SINGLE WORD WORD -> CITY CITY CITY -> 0.3
SINGLE WORD WORD WORD -> CITY CITY CITY CITY -> 0.2
SINGLE WORD SINGLE WORD -> CITY CITY CITY CITY -> 0.4
TYPE -> CITY -> 0.9
TYPE DIRECT -> CITY CITY -> 0.2
TYPE DOUBLE WORD -> CITY CITY CITY -> 0.2
TYPE TYPE -> CITY CITY -> 0.2
TYPE TYPE NUMBER SINGLE -> CITY CITY CITY CITY -> 0.3
TYPE TYPE WORD NUMBER -> CITY CITY CITY CITY -> 0.3
TYPE TYPE WORD WORD NUMBER -> CITY CITY CITY CITY CITY -> 0.3
TYPE WORD -> CITY CITY -> 0.2
TYPE WORD NUMBER -> CITY CITY CITY -> 0.2
TYPE WORD TYPE -> CITY CITY CITY -> 0.2
TYPE WORD WORD -> CITY CITY CITY -> 0.1
TYPE WORD WORD WORD NUMBER SINGLE -> CITY CITY CITY CITY CITY CITY -> 0.1
WORD -> CITY -> 0.5
WORD DIRECT -> CITY CITY -> 0.5
WORD DIRECT TYPE -> CITY CITY CITY -> 0.1
WORD DIRECT WORD -> CITY CITY CITY -> 0.1
WORD DOUBLE -> CITY CITY -> 0.5
WORD DOUBLE PROV -> CITY CITY CITY -> 0.5
WORD DOUBLE WORD -> CITY CITY CITY -> 0.3
WORD DOUBLE WORD WORD -> CITY CITY CITY CITY -> 0.2
WORD NUMBER -> CITY CITY -> 0.4
WORD NUMBER SINGLE -> CITY CITY CITY -> 0.5
WORD NUMBER WORD -> CITY CITY CITY -> 0.4
WORD NUMBER WORD DIRECT WORD -> CITY CITY CITY CITY CITY -> 0.4
WORD NUMBER WORD SINGLE -> CITY CITY CITY CITY -> 0.2
WORD NUMBER WORD TYPE -> CITY CITY CITY CITY -> 0.2
WORD PROV -> CITY CITY -> 0.5
WORD PROV NUMBER -> CITY CITY CITY -> 0.4
WORD PROV TYPE -> CITY CITY CITY -> 0.3
WORD SINGLE NUMBER -> CITY CITY CITY -> 0.5
WORD SINGLE NUMBER SINGLE -> CITY CITY CITY CITY -> 0.5
WORD SINGLE TYPE WORD NUMBER -> CITY CITY CITY CITY CITY -> 0.4
WORD SINGLE TYPE NUMBER -> CITY CITY CITY CITY -> 0.5
WORD SINGLE TYPE NUMBER SINGLE -> CITY CITY CITY CITY CITY -> 0.5
WORD SINGLE WORD -> CITY CITY CITY -> 0.2
WORD SINGLE WORD WORD -> CITY CITY CITY CITY -> 0.2
WORD SINGLE WORD NUMBER -> CITY CITY CITY CITY -> 0.5
WORD SLASH DIRECT WORD -> CITY CITY CITY CITY -> 0.5
WORD SLASH WORD -> CITY CITY CITY -> 0.5
WORD SLASH WORD TYPE -> CITY CITY CITY CITY -> 0.5
WORD SLASH WORD WORD -> CITY CITY CITY CITY -> 0.5
WORD TYPE -> CITY CITY -> 0.5
WORD TYPE DIRECT -> CITY CITY CITY -> 0.2
WORD TYPE NUMBER SINGLE -> CITY CITY CITY CITY -> 0.4
WORD TYPE TYPE -> CITY CITY CITY -> 0.2
WORD TYPE TYPE WORD NUMBER SINGLE -> CITY CITY CITY CITY CITY CITY -> 0.2
WORD TYPE TYPE WORD SINGLE -> CITY CITY CITY CITY CITY -> 0.2
WORD TYPE WORD NUMBER -> CITY CITY CITY CITY -> 0.2
WORD TYPE WORD NUMBER NUMBER -> CITY CITY CITY CITY CITY -> 0.3
WORD TYPE WORD NUMBER SINGLE -> CITY CITY CITY CITY CITY -> 0.3
WORD TYPE WORD WORD -> CITY CITY CITY CITY -> 0.1
WORD WORD -> CITY CITY -> 0.4
WORD WORD DIRECT -> CITY CITY CITY -> 0.3
WORD WORD DOUBLE DOUBLE -> CITY CITY CITY CITY -> 0.3
WORD WORD DOUBLE TYPE WORD -> CITY CITY CITY CITY CITY -> 0.3
WORD WORD DOUBLE TYPE WORD TYPE -> CITY CITY CITY CITY CITY CITY -> 0.3
WORD WORD NUMBER -> CITY CITY CITY -> 0.3
WORD WORD NUMBER NUMBER -> CITY CITY CITY CITY -> 0.3
WORD WORD NUMBER SINGLE -> CITY CITY CITY CITY -> 0.3
WORD WORD SINGLE -> CITY CITY CITY -> 0.2
WORD WORD SINGLE WORD -> CITY CITY CITY CITY -> 0.2
WORD WORD SINGLE WORD SINGLE WORD -> CITY CITY CITY CITY CITY CITY -> 0.2
WORD WORD SINGLE WORD WORD -> CITY CITY CITY CITY CITY -> 0.2
WORD WORD SLASH WORD -> CITY CITY CITY CITY -> 0.4
WORD WORD SLASH WORD WORD -> CITY CITY CITY CITY CITY -> 0.4
WORD WORD TYPE -> CITY CITY CITY -> 0.2
WORD WORD TYPE NUMBER -> CITY CITY CITY CITY -> 0.3
WORD WORD TYPE WORD -> CITY CITY CITY CITY -> 0.2
WORD WORD TYPE WORD NUMBER SINGLE -> CITY CITY CITY CITY CITY CITY -> 0.3
WORD WORD WORD -> CITY CITY CITY -> 0.3
WORD WORD WORD DIRECT -> CITY CITY CITY CITY -> 0.3
WORD WORD WORD NUMBER -> CITY CITY CITY CITY -> 0.3
WORD WORD WORD NUMBER SINGLE -> CITY CITY CITY CITY CITY -> 0.3
WORD WORD WORD TYPE -> CITY CITY CITY CITY -> 0.05
WORD WORD WORD WORD -> CITY CITY CITY CITY -> 0.2
WORD WORD WORD WORD WORD -> CITY CITY CITY CITY CITY -> 0.1
WORD WORD WORD WORD WORD WORD -> CITY CITY CITY CITY CITY CITY -> 0.05
WORD WORD WORD WORD WORD WORD WORD -> CITY CITY CITY CITY CITY CITY CITY -> 0.02
WORD WORD WORD WORD WORD WORD WORD WORD -> CITY CITY CITY CITY CITY CITY CITY CITY -> 0.01

[STREET]
DIRECT TYPE -> PREDIR STREET -> 0.5
DIRECT TYPE TYPE -> PREDIR STREET SUFTYP -> 0.5
DIRECT WORD TYPE -> PREDIR STREET SUFTYP -> 0.5
DIRECT WORD TYPE TYPE -> PREDIR STREET STREET SUFTYP -> 0.5
MIXED TYPE -> STREET SUFTYP -> 0.5
MIXED TYPE DIRECT -> STREET SUFTYP SUFDIR -> 0.5
MIXED TYPE TYPE -> STREET STREET SUFDIR -> 0.5
NUMBER SINGLE TYPE -> STREET STREET SUFTYP -> 0.5
NUMBER SINGLE TYPE DIRECT -> STREET STREET SUFTYP SUFDIR -> 0.5
NUMBER SINGLE TYPE WORD -> STREET STREET STREET SUFDIR -> 0.5
NUMBER TYPE -> STREET SUFTYP -> 0.8
NUMBER TYPE DIRECT -> STREET SUFTYP SUFDIR -> 0.5
NUMBER TYPE DIRECT DIRECT -> STREET SUFTYP SUFDIR SUFDIR -> 0.5
NUMBER TYPE TYPE NUMBER -> STREET STREET STREET STREET -> 0.5
NUMBER WORD TYPE -> STREET STREET SUFTYP -> 0.5
NUMBER WORD TYPE DIRECT -> STREET STREET SUFTYP SUFDIR -> 0.5
NUMBER WORD TYPE DIRECT DIRECT -> STREET STREET SUFTYP SUFDIR SUFDIR -> 0.5
PROV TYPE -> STREET SUFTYP -> 0.5
SINGLE WORD TYPE -> STREET STREET SUFTYP -> 0.5
TYPE -> STREET -> 0.5
TYPE NUMBER -> PRETYP STREET -> 0.8
TYPE NUMBER DIRECT -> PRETYP STREET SUFDIR -> 0.5
TYPE NUMBER SINGLE -> PRETYP STREET STREET -> 0.5
TYPE NUMBER SINGLE DIRECT -> PRETYP STREET STREET SUFDIR -> 0.5
TYPE NUMBER TYPE -> PRETYP STREET SUFTYP -> 0.5
TYPE NUMBER TYPE DIRECT -> PRETYP STREET SUFTYP SUFDIR -> 0.5
TYPE NUMBER WORD TYPE NUMBER -> PRETYP STREET STREET STREET STREET -> 0.5
TYPE NUMBER WORD -> PRETYP STREET STREET -> 0.5
TYPE NUMBER SINGLE WORD TYPE NUMBER SINGLE -> PRETYP STREET STREET STREET STREET STREET STREET -> 0.5
TYPE SINGLE WORD -> PRETYP STREET STREET -> 0.5
TYPE SINGLE SINGLE WORD -> PRETYP STREET STREET STREET -> 0.5
TYPE TYPE -> PRETYP STREET -> 0.5
TYPE TYPE DIRECT -> PRETYP STREET SUFDIR -> 0.8
TYPE TYPE NUMBER -> PRETYP STREET STREET -> 0.8
TYPE TYPE NUMBER SINGLE -> PRETYP STREET STREET STREET -> 0.8
TYPE TYPE TYPE -> PRETYP STREET SUFTYP -> 0.5
TYPE TYPE WORD -> PRETYP STREET STREET -> 0.5
TYPE TYPE WORD WORD -> PRETYP STREET STREET STREET -> 0.5
TYPE WORD -> PRETYP STREET -> 0.8
TYPE WORD DIRECT -> PRETYP STREET SUFDIR -> 0.5
TYPE WORD DIRECT DIRECT -> PRETYP STREET SUFDIR SUFDIR -> 0.5
TYPE WORD SINGLE TYPE -> PRETYP STREET STREET SUFTYP -> 0.5
TYPE WORD SINGLE WORD -> PRETYP STREET STREET STREET -> 0.5
TYPE WORD TYPE -> PRETYP STREET SUFTYP -> 0.5
TYPE WORD WORD -> PRETYP STREET STREET -> 0.5
TYPE WORD WORD DIRECT -> PRETYP STREET STREET SUFDIR -> 0.5
TYPE WORD WORD WORD -> PRETYP STREET STREET STREET -> 0.5
WORD -> STREET -> 0.5
WORD MIXED TYPE -> STREET STREET SUFTYP -> 0.5
WORD SINGLE TYPE -> STREET STREET SUFTYP -> 0.5
WORD TYPE -> STREET SUFTYP -> 0.8
WORD TYPE DIRECT -> STREET SUFTYP SUFDIR -> 0.5
WORD TYPE DIRECT DIRECT -> STREET SUFTYP SUFDIR SUFDIR -> 0.5
WORD TYPE NUMBER -> STREET SUFTYP STREET -> 0.5
WORD TYPE NUMBER TYPE -> STREET STREET STREET SUFTYP -> 0.5
WORD TYPE TYPE -> STREET STREET SUFTYP -> 0.5
WORD TYPE TYPE DIRECT -> STREET STREET SUFTYP SUFDIR -> 0.5
WORD TYPE TYPE DIRECT DIRECT -> STREET STREET SUFTYP SUFDIR SUFDIR -> 0.5
WORD TYPE TYPE TYPE -> STREET STREET STREET SUFTYP -> 0.5
WORD TYPE WORD TYPE -> STREET STREET STREET SUFTYP -> 0.5
WORD WORD TYPE -> STREET STREET SUFTYP -> 0.5
WORD WORD -> STREET STREET -> 0.5
WORD WORD TYPE DIRECT DIRECT -> STREET STREET SUFTYP SUFDIR SUFDIR -> 0.5
WORD WORD TYPE TYPE -> STREET STREET STREET SUFTYP -> 0.5
WORD WORD WORD TYPE -> STREET STREET STREET SUFTYP -> 0.5
WORD WORD WORD WORD -> STREET STREET STREET STREET -> 0.2
WORD WORD WORD WORD WORD -> STREET STREET STREET STREET STREET -> 0.1
WORD WORD WORD WORD WORD WORD -> STREET STREET STREET STREET STREET STREET -> 0.05
WORD WORD WORD WORD WORD WORD WORD -> STREET STREET STREET STREET STREET STREET STREET -> 0.02
WORD WORD WORD WORD WORD WORD WORD WORD -> STREET STREET STREET STREET STREET STREET STREET STREET -> 0.01


[HOUSE]
NUMBER -> HOUSE -> 0.9

$$ where id=26;
vacuum analyze as_config;
